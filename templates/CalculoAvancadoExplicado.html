<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulário de Cálculo Tributário</title>
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <!-- Bootstrap Icons (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Arquivo CSS personalizado -->
    <link rel="stylesheet" href="{{ url_for('static', filename='estilo.css') }}">
</head>
<body>
    <a href="/" style="display:inline-block;margin-bottom:16px;padding:8px 16px;background:#4caf50;color:#fff;border-radius:5px;text-decoration:none;font-weight:bold;">← Voltar ao menu</a>
    <div class="container-fluid">
        <h1 class="text-center my-4">Cálculo Avançado Explicado</h1>
        <div class="theme-toggle text-center mb-3">
            <button class="btn btn-outline-primary btn-sm" onclick="toggleTheme()">Alternar Tema</button>
        </div>
        <div class="row justify-content-start">
            <!-- Quadro CUSTO VARIÁVEL (Compra) -->
            <div class="col-md-6">
                <div class="form-container">
                    <h1 class="text-center mb-2">CUSTO VARIÁVEL (Compra)</h1>
                    <form id="formTributario">
                        <div class="form-group mb-2">
                            <label for="precoCompra" class="form-label">Preço de Compra (+):</label>
                            <div class="input-group">
                                <input type="text" id="precoCompra" class="form-control monetario" placeholder="R$ 0,0000" required>
                                <span class="input-group-text label-valor" id="label-precoCompra">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="ipiCompra" class="form-label">IPI s/ Compra (+):</label>
                            <div class="input-group">
                                <input type="number" id="ipiCompra" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-ipiCompra">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="creditoIcms" class="form-label">Crédito de ICMS (-):</label>
                            <div class="input-group">
                                <input type="number" id="creditoIcms" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-creditoIcms">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="creditoIpi" class="form-label">Crédito de IPI (-):</label>
                            <div class="input-group">
                                <input type="number" id="creditoIpi" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-creditoIpi">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="creditoPis" class="form-label">Crédito de PIS (-):</label>
                            <div class="input-group">
                                <input type="number" id="creditoPis" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-creditoPis">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="creditoCofins" class="form-label">Crédito de COFINS (-):</label>
                            <div class="input-group">
                                <input type="number" id="creditoCofins" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-creditoCofins">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="subTributaria" class="form-label">Substituição Tributária (+):</label>
                            <div class="input-group">
                                <input type="text" id="subTributaria" class="form-control monetario" placeholder="R$ 0,0000">
                                <span class="input-group-text label-valor" id="label-subTributaria">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="difAliquota" class="form-label">Diferencial de Alíquotas (+):</label>
                            <div class="input-group">
                                <input type="number" id="difAliquota" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-difAliquota">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="custoAdicional" class="form-label">Custo Adicional (+):</label>
                            <div class="input-group">
                                <input type="text" id="custoAdicional" class="form-control monetario" placeholder="R$ 0,0000">
                                <span class="input-group-text label-valor" id="label-custoAdicional">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="frete" class="form-label">Frete (+):</label>
                            <div class="input-group">
                                <input type="text" id="frete" class="form-control monetario" placeholder="R$ 0,0000">
                                <span class="input-group-text label-valor" id="label-frete">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            
                        </div>
                    </form>
                        <div class="text-center mt-3">
                            
                        </div>
                    <div class="mt-2 text-center">
                        <strong>Total de Custo Variável: </strong><span id="total-resultado">R$ 0,00</span>
                    </div>
                </div>
            </div>
            <!-- Quadro DESPESAS VARIÁVEIS (Venda) -->
            <div class="col-md-6">
                <div class="form-container">
                    <h1 class="text-center mb-2">DESPESAS VARIÁVEIS (Venda)</h1>
                    <form id="formDespesasVenda">
                        <div class="form-group mb-2">
                            <label for="icmsVenda" class="form-label">ICMS s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="icmsVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-icmsVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="ipiVenda" class="form-label">IPI s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="ipiVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-ipiVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="pisVenda" class="form-label">PIS s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="pisVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-pisVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="cofinsVenda" class="form-label">COFINS s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="cofinsVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-cofinsVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="impostosSimplesVenda" class="form-label">Impostos Simples s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="impostosSimplesVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-impostosSimplesVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="irpjVenda" class="form-label">IRPJ s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="irpjVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-irpjVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="csllVenda" class="form-label">CSLL s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="csllVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-csllVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="freteVenda" class="form-label">Frete s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="freteVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-freteVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="comissoesVenda" class="form-label">Comissões s/ Venda (+):</label>
                            <div class="input-group">
                                <input type="number" id="comissoesVenda" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-comissoesVenda">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="outrasDespesas" class="form-label">Outras Despesas Variáveis (+):</label>
                            <div class="input-group">
                                <input type="number" id="outrasDespesas" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-outrasDespesas">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            
                        </div>
                    </form>
                    <div class="mt-2 text-center">
                        <strong>Total de Despesas Variáveis: </strong><span id="total-despesas-variaveis">R$ 0,00</span>
                    </div>
                </div>
            </div>
            <!-- Quadro PREÇO E MARGEM -->
            <div class="col-md-6">
                <div class="form-container">
                    <h1 class="text-center mb-2">PREÇO E MARGEM</h1>
                    <form id="formPrecoMargem">
                        <div class="form-group mb-2">
                            <label for="margemDesejada" class="form-label">Margem Desejada (+):</label>
                            <div class="input-group">
                                <input type="number" id="margemDesejada" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000">
                                <span class="input-group-text label-valor" id="label-margemDesejada">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="precoVenda" class="form-label">Preço de Venda (+):</label>
                            <div class="input-group">
                                <input type="text" id="precoVenda" class="form-control monetario" placeholder="R$ 0,0000">
                                <span class="input-group-text label-valor" id="label-precoVenda">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="precoSugerido" class="form-label">Preço Sugerido:</label>
                            <div class="input-group">
                                <input type="text" id="precoSugerido" class="form-control monetario" placeholder="R$ 0,0000" readonly>
                                <span class="input-group-text label-valor" id="label-precoSugerido">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="markup" class="form-label">Markup:</label>
                            <div class="input-group">
                                <input type="number" id="markup" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000" readonly>
                                <span class="input-group-text label-valor" id="label-markup">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="lucroBruto" class="form-label">Lucro Bruto:</label>
                            <div class="input-group">
                                <input type="text" id="lucroBruto" class="form-control monetario" placeholder="R$ 0,0000" readonly>
                                <span class="input-group-text label-valor" id="label-lucroBruto">R$ 0,00</span>
                                <span class="input-group-text"><i class="bi bi-currency-real"></i> R$</span>
                            </div>
                        </div>
                        <div class="form-group mb-2">
                            <label for="margemLucroBruto" class="form-label">Margem Lucro Bruto:</label>
                            <div class="input-group">
                                <input type="number" id="margemLucroBruto" class="form-control percentual" step="0.0001" min="0" placeholder="0.0000" readonly>
                                <span class="input-group-text label-valor" id="label-margemLucroBruto">0.0000%</span>
                                <span class="input-group-text"><i class="bi bi-percent"></i></span>
                            </div>
                        </div>
                        <div class="text-center mt-3">
                            <button id="statusLucroBtn" type="button" class="btn btn-secondary rounded-pill px-5" disabled>Neutro</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="container mt-4">
        <div class="accordion" id="faqIndicativo">
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingIndicativo">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseIndicativo" aria-expanded="false" aria-controls="collapseIndicativo">
                        🧾 Explicação: Como o sistema mostra o status do lucro
                    </button>
                </h2>
                <div id="collapseIndicativo" class="accordion-collapse collapse" aria-labelledby="headingIndicativo" data-bs-parent="#faqIndicativo">
                    <div class="accordion-body" style="white-space: pre-line;">
🧾 Explicação: Como o sistema mostra o status do lucro
O sistema possui um botão que serve como indicador visual do desempenho financeiro de uma operação. Esse botão muda de cor e de texto conforme o resultado do lucro bruto em relação ao valor que era esperado.
A lógica funciona assim:
- 🔴 Prejuízo: Se o lucro for negativo, o botão mostra "Prejuízo" com cor vermelha.
- 🟢 Acima do Esperado: Se o lucro for maior que o valor esperado, o botão mostra "Acima do Esperado" com cor verde.
- 🟡 Dentro do Esperado: Se o lucro estiver praticamente igual ao valor esperado, o botão mostra "Dentro do Esperado" com cor amarela.
- ⚪ Neutro: Se não se encaixar em nenhuma das situações acima, o botão mostra "Neutro" com cor cinza.
Esse botão é apenas informativo — ele aparece desativado, servindo como alerta visual sem permitir interação.

💡 Exemplo prático:
Imagine que o lucro bruto de uma venda foi de R$ 1.000,00, e o valor desejado era R$ 950,00.
- Como o lucro foi maior que o esperado, o sistema vai mostrar:
- 🟢 Texto: "Acima do Esperado"
- Cor: Verde
Agora, se o lucro tivesse sido exatamente R$ 950,00, o botão mostraria:
- 🟡 Texto: "Dentro do Esperado"
- Cor: Amarela
Se fosse R$ 949,99, o sistema mostraria:
- ⚪ Texto: "Neutro"
- Cor: Cinza
E se fosse R$ -100,00, o botão indicaria:
- 🔴 Texto: "Prejuízo"
- Cor: Vermelha
                    </div>
                </div>
            </div>
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingPrecoSugerido">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapsePrecoSugerido" aria-expanded="false" aria-controls="collapsePrecoSugerido">
                        💡 Como funciona o Preço Sugerido?
                    </button>
                </h2>
                <div id="collapsePrecoSugerido" class="accordion-collapse collapse" aria-labelledby="headingPrecoSugerido" data-bs-parent="#faqIndicativo">
                    <div class="accordion-body">
                        O <strong>Preço Sugerido</strong> é o menor valor de venda que garante a margem de lucro desejada, considerando todos os custos e despesas informados. Se você diminuir a margem desejada, o preço sugerido também diminui. Se aumentar a margem, o preço sugerido sobe. Assim, você sempre sabe o valor mínimo para não vender com prejuízo ou abaixo da sua meta.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap 5 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <!-- Arquivo JavaScript externo -->
    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>